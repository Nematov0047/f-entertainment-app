data = JSON.parse(`[
  {
    "title": "Beyond Earth",
    "thumbnail": {
      "trending": {
        "small": "./assets/thumbnails/beyond-earth/trending/small.jpg",
        "large": "./assets/thumbnails/beyond-earth/trending/large.jpg"
      },
      "regular": {
        "small": "./assets/thumbnails/beyond-earth/regular/small.jpg",
        "medium": "./assets/thumbnails/beyond-earth/regular/medium.jpg",
        "large": "./assets/thumbnails/beyond-earth/regular/large.jpg"
      }
    },
    "year": 2019,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": true
  },
  {
    "title": "Bottom Gear",
    "thumbnail": {
      "trending": {
        "small": "./assets/thumbnails/bottom-gear/trending/small.jpg",
        "large": "./assets/thumbnails/bottom-gear/trending/large.jpg"
      },
      "regular": {
        "small": "./assets/thumbnails/bottom-gear/regular/small.jpg",
        "medium": "./assets/thumbnails/bottom-gear/regular/medium.jpg",
        "large": "./assets/thumbnails/bottom-gear/regular/large.jpg"
      }
    },
    "year": 2021,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": true
  },
  {
    "title": "Undiscovered Cities",
    "thumbnail": {
      "trending": {
        "small": "./assets/thumbnails/undiscovered-cities/trending/small.jpg",
        "large": "./assets/thumbnails/undiscovered-cities/trending/large.jpg"
      },
      "regular": {
        "small": "./assets/thumbnails/undiscovered-cities/regular/small.jpg",
        "medium": "./assets/thumbnails/undiscovered-cities/regular/medium.jpg",
        "large": "./assets/thumbnails/undiscovered-cities/regular/large.jpg"
      }
    },
    "year": 2019,
    "category": "TV Series",
    "rating": "E",
    "isBookmarked": false,
    "isTrending": true
  },
  {
    "title": "1998",
    "thumbnail": {
      "trending": {
        "small": "./assets/thumbnails/1998/trending/small.jpg",
        "large": "./assets/thumbnails/1998/trending/large.jpg"
      },
      "regular": {
        "small": "./assets/thumbnails/1998/regular/small.jpg",
        "medium": "./assets/thumbnails/1998/regular/medium.jpg",
        "large": "./assets/thumbnails/1998/regular/large.jpg"
      }
    },
    "year": 2021,
    "category": "Movie",
    "rating": "18+",
    "isBookmarked": false,
    "isTrending": true
  },
  {
    "title": "Dark Side of the Moon",
    "thumbnail": {
      "trending": {
        "small": "./assets/thumbnails/dark-side-of-the-moon/trending/small.jpg",
        "large": "./assets/thumbnails/dark-side-of-the-moon/trending/large.jpg"
      },
      "regular": {
        "small": "./assets/thumbnails/dark-side-of-the-moon/regular/small.jpg",
        "medium": "./assets/thumbnails/dark-side-of-the-moon/regular/medium.jpg",
        "large": "./assets/thumbnails/dark-side-of-the-moon/regular/large.jpg"
      }
    },
    "year": 2018,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": true,
    "isTrending": true
  },
  {
    "title": "The Great Lands",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/the-great-lands/regular/small.jpg",
        "medium": "./assets/thumbnails/the-great-lands/regular/medium.jpg",
        "large": "./assets/thumbnails/the-great-lands/regular/large.jpg"
      }
    },
    "year": 2019,
    "category": "Movie",
    "rating": "E",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "The Diary",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/the-diary/regular/small.jpg",
        "medium": "./assets/thumbnails/the-diary/regular/medium.jpg",
        "large": "./assets/thumbnails/the-diary/regular/large.jpg"
      }
    },
    "year": 2019,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Earthâ€™s Untouched",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/earths-untouched/regular/small.jpg",
        "medium": "./assets/thumbnails/earths-untouched/regular/medium.jpg",
        "large": "./assets/thumbnails/earths-untouched/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "18+",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "No Land Beyond",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/no-land-beyond/regular/small.jpg",
        "medium": "./assets/thumbnails/no-land-beyond/regular/medium.jpg",
        "large": "./assets/thumbnails/no-land-beyond/regular/large.jpg"
      }
    },
    "year": 2019,
    "category": "Movie",
    "rating": "E",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "During the Hunt",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/during-the-hunt/regular/small.jpg",
        "medium": "./assets/thumbnails/during-the-hunt/regular/medium.jpg",
        "large": "./assets/thumbnails/during-the-hunt/regular/large.jpg"
      }
    },
    "year": 2016,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Autosport the Series",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/autosport-the-series/regular/small.jpg",
        "medium": "./assets/thumbnails/autosport-the-series/regular/medium.jpg",
        "large": "./assets/thumbnails/autosport-the-series/regular/large.jpg"
      }
    },
    "year": 2016,
    "category": "TV Series",
    "rating": "18+",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Same Answer II",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/same-answer-2/regular/small.jpg",
        "medium": "./assets/thumbnails/same-answer-2/regular/medium.jpg",
        "large": "./assets/thumbnails/same-answer-2/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "E",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Below Echo",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/below-echo/regular/small.jpg",
        "medium": "./assets/thumbnails/below-echo/regular/medium.jpg",
        "large": "./assets/thumbnails/below-echo/regular/large.jpg"
      }
    },
    "year": 2016,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "The Rockies",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/the-rockies/regular/small.jpg",
        "medium": "./assets/thumbnails/the-rockies/regular/medium.jpg",
        "large": "./assets/thumbnails/the-rockies/regular/large.jpg"
      }
    },
    "year": 2015,
    "category": "TV Series",
    "rating": "E",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Relentless",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/relentless/regular/small.jpg",
        "medium": "./assets/thumbnails/relentless/regular/medium.jpg",
        "large": "./assets/thumbnails/relentless/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Community of Ours",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/community-of-ours/regular/small.jpg",
        "medium": "./assets/thumbnails/community-of-ours/regular/medium.jpg",
        "large": "./assets/thumbnails/community-of-ours/regular/large.jpg"
      }
    },
    "year": 2018,
    "category": "TV Series",
    "rating": "18+",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Van Life",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/van-life/regular/small.jpg",
        "medium": "./assets/thumbnails/van-life/regular/medium.jpg",
        "large": "./assets/thumbnails/van-life/regular/large.jpg"
      }
    },
    "year": 2015,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "The Heiress",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/the-heiress/regular/small.jpg",
        "medium": "./assets/thumbnails/the-heiress/regular/medium.jpg",
        "large": "./assets/thumbnails/the-heiress/regular/large.jpg"
      }
    },
    "year": 2021,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Off the Track",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/off-the-track/regular/small.jpg",
        "medium": "./assets/thumbnails/off-the-track/regular/medium.jpg",
        "large": "./assets/thumbnails/off-the-track/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "18+",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Whispering Hill",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/whispering-hill/regular/small.jpg",
        "medium": "./assets/thumbnails/whispering-hill/regular/medium.jpg",
        "large": "./assets/thumbnails/whispering-hill/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "E",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "112",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/112/regular/small.jpg",
        "medium": "./assets/thumbnails/112/regular/medium.jpg",
        "large": "./assets/thumbnails/112/regular/large.jpg"
      }
    },
    "year": 2013,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Lone Heart",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/lone-heart/regular/small.jpg",
        "medium": "./assets/thumbnails/lone-heart/regular/medium.jpg",
        "large": "./assets/thumbnails/lone-heart/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "E",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Production Line",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/production-line/regular/small.jpg",
        "medium": "./assets/thumbnails/production-line/regular/medium.jpg",
        "large": "./assets/thumbnails/production-line/regular/large.jpg"
      }
    },
    "year": 2018,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Dogs",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/dogs/regular/small.jpg",
        "medium": "./assets/thumbnails/dogs/regular/medium.jpg",
        "large": "./assets/thumbnails/dogs/regular/large.jpg"
      }
    },
    "year": 2016,
    "category": "TV Series",
    "rating": "E",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Asia in 24 Days",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/asia-in-24-days/regular/small.jpg",
        "medium": "./assets/thumbnails/asia-in-24-days/regular/medium.jpg",
        "large": "./assets/thumbnails/asia-in-24-days/regular/large.jpg"
      }
    },
    "year": 2020,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "The Tasty Tour",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/the-tasty-tour/regular/small.jpg",
        "medium": "./assets/thumbnails/the-tasty-tour/regular/medium.jpg",
        "large": "./assets/thumbnails/the-tasty-tour/regular/large.jpg"
      }
    },
    "year": 2016,
    "category": "TV Series",
    "rating": "PG",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Darker",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/darker/regular/small.jpg",
        "medium": "./assets/thumbnails/darker/regular/medium.jpg",
        "large": "./assets/thumbnails/darker/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "18+",
    "isBookmarked": true,
    "isTrending": false
  },
  {
    "title": "Unresolved Cases",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/unresolved-cases/regular/small.jpg",
        "medium": "./assets/thumbnails/unresolved-cases/regular/medium.jpg",
        "large": "./assets/thumbnails/unresolved-cases/regular/large.jpg"
      }
    },
    "year": 2018,
    "category": "TV Series",
    "rating": "18+",
    "isBookmarked": false,
    "isTrending": false
  },
  {
    "title": "Mission: Saturn",
    "thumbnail": {
      "regular": {
        "small": "./assets/thumbnails/mission-saturn/regular/small.jpg",
        "medium": "./assets/thumbnails/mission-saturn/regular/medium.jpg",
        "large": "./assets/thumbnails/mission-saturn/regular/large.jpg"
      }
    },
    "year": 2017,
    "category": "Movie",
    "rating": "PG",
    "isBookmarked": true,
    "isTrending": false
  }
]`)


/* JS code begins here */
function generate_trending_item({title, url, year, category, rating, isBookmarked}) {
    return `<div class="trending-item">
                    <img src="${url}" alt="Beyond Earth thumbnail" class="item-img">
                    <div class="item-bookmark bg-dark-blue ${isBookmarked ? 'item-bookmark-active': ''}"><img src="./assets/icon-bookmark-empty.svg" style="height: 14px;" alt="bookmark empty"></div>
                    <div class="item-info pure-white">
                        <div class="info-top">
                            <span class="body-m  mobile-body-m">${year}</span>
                            <div class="dot"></div>
                            <span class="body-m  mobile-body-m"><img src="./assets/icon-category-${category == 'Movie' ? 'movie' : 'tv'}.svg" alt="movie icon"> ${category}</span>
                            <div class="dot"></div>
                            <span class="body-m  mobile-body-m">${rating}</span>
                        </div>
                        <h3 class="heading-s mobile-heading-s">${title}</h3>
                    </div>
                    <div class="play pure-white">
                        <img src="./assets/icon-play.svg" alt="play" class="paly-icon">
                        <span class="heading-xs play-text">Play</span>
                    </div>
                </div>`
}

function generate_trending_list() {
    trending_items = data.filter(item => item.isTrending)
    resp = ''
    trending_items.map((item) => {
        resp += generate_trending_item({
            'title':item.title,
            'category':item.category,
            'isBookmarked': item.isBookmarked,
            'rating': item.rating,
            'year':item.year,
            'url':item.thumbnail.trending.small
        });
    })

    return `<h2 class="heading-l mobile-heading-l mt-24 mb-24 pure-white">Trending</h2>
            <div class="trending-list">
                ${resp}
            </div>`
}

function generate_rec_item({url, isBookmarked, year, category, rating, title}) {
    return `<div class="rec-item">
                <div class="rec-rel-img">
                    <img src="${url}" alt="${title} thumbnail" class="rec-item-img">
                    <div class="rec-item-bookmark item-bookmark bg-dark-blue ${isBookmarked ? 'item-bookmark-active': ''}"><img src="./assets/icon-bookmark-empty.svg" style="height: 14px;" alt="bookmark empty"></div>
                    <div class="play pure-white">
                        <img src="./assets/icon-play.svg" alt="play" class="paly-icon">
                        <span class="heading-xs play-text">Play</span>
                    </div>
                </div>
                <div class="rec-item-info pure-white">
                    <div class="info-top">
                        <span class="body-m tablet-body-s mobile-body-s">${year}</span>
                        <div class="dot"></div>
                        <span class="body-m tablet-body-s mobile-body-s">
                        <img src="./assets/icon-category-${category == 'Movie' ? 'movie' : 'tv'}.svg" alt="movie icon"> ${category}</span>
                        <div class="dot"></div>
                        <span class="body-m tablet-body-s mobile-body-s">${rating}</span>
                    </div>
                    <h3 class="heading-s tablet-heading-xs mobile-heading-xs">${title}</h3>
                </div>
            </div>`;
}

function generate_page(data, title, classes) {
    rec_data = data;
    resp = '';
    rec_data.map(item => {
                    resp += generate_rec_item({
                        'url': item.thumbnail.regular.small,
                        'isBookmarked': item.isBookmarked,
                        'year': item.year,
                        'category': item.category,
                        'rating': item.rating,
                        'title': item.title
                    });
                })
    
    return `<h2 class="pure-white heading-l mobile-heading-l ${classes}">${title}</h2>
            <div class="rec-list">
                ${resp}
            </div>`
}

function generate_rec_list() {
    rec_data = data.filter((item) => !item.isTrending);
    return generate_page(rec_data, 'Recommended for you', 'mt-36 mb-36')
}

function generate_home_page() {
    return generate_trending_list() + generate_rec_list();
}

root = document.getElementById('root');

home_icon = document.getElementById('home-icon');
movie_icon = document.getElementById('movie-icon');
tv_icon = document.getElementById('tv-icon');
bookmark_icon = document.getElementById('bookmark-icon');

let currentPage = '';

function render(arg, pageName, func=true) {
    if (func == true) {
        root.innerHTML = arg();
    } else {
        root.innerHTML = arg;
    }
    home_icon.classList.remove('nav-icon-active');
    movie_icon.classList.remove('nav-icon-active');
    tv_icon.classList.remove('nav-icon-active');
    bookmark_icon.classList.remove('nav-icon-active');

    switch (pageName) {
      case 'home':
        home_icon.classList.add('nav-icon-active');
        break;
      case 'movies':
        movie_icon.classList.add('nav-icon-active');
        break;
      case 'tv':
        tv_icon.classList.add('nav-icon-active');
        break;
      case 'bookmark':
        bookmark_icon.classList.add('nav-icon-active');
        break;
    }

    currentPage = pageName;

}

render(generate_home_page,'home')

function generate_movies_page() {
    movie_data = data.filter((item) => item.category == 'Movie' ? true : false);
    return generate_page(movie_data, 'Movies', 'mt-24 mb-24') 
}

function generate_tv_page() {
    tv_data = data.filter((item) => item.category == 'TV Series' ? true : false);
    return generate_page(tv_data, 'TV Series', 'mt-24 mb-24')
}

function generate_bookmarked_page() {
    movie_data = data.filter((item) => item.category == 'Movie' && item.isBookmarked ? true : false);
    tv_data = data.filter((item) => item.category == 'TV Series' && item.isBookmarked ? true : false);
    return generate_page(movie_data, 'Bookmarked Movies', 'mt-24 mb-24') + generate_page(tv_data, 'Bookmarked TV Series', 'mt-24 mb-24')
}

// function search_result(search_data) {
//     rec_data = search_data
//     resp = ''
//     rec_data.map(item => {
//                     resp += generate_rec_item({
//                         'url': item.thumbnail.regular.small,
//                         'isBookmarked': item.isBookmarked,
//                         'year': item.year,
//                         'category': item.category,
//                         'rating': item.rating,
//                         'title': item.title
//                     });
//                 })
//     return `<h2 class="pure-white mt-24 mb-24 heading-l">Found ${resp_data.length} results for '${}'</h2>
//             <div class="rec-list">${resp}</div>`
// }


search_input = document.getElementById('search-input');
search_input.addEventListener('input', (e) => {
    search = e.target.value.toLowerCase();
    if (search.length === 0) {
      switch (currentPage) {
        case 'home':
          render(generate_home_page, 'home');
          break;
        case 'movies':
          render(generate_movies_page, 'movies');
          break;
        case 'tv':
          render(generate_tv_page, 'tv');
          break;
        case 'bookmark':
          render(generate_bookmarked_page, 'bookmark');
          break;
      }
      return;
    }
    switch(currentPage) {
      case 'home':
        search_data = data.filter(item => {
            if (item.category.toLowerCase().match(search) || String(item.year).toLowerCase().match(search) || item.title.toLowerCase().match(search)) {
                return true
            } else {
                return false;
            }
        })        
        break;
      case 'movies':
        search_data = data.filter(item => {
            if ((item.category.toLowerCase().match(search) || String(item.year).toLowerCase().match(search) || item.title.toLowerCase().match(search)) && item.category == 'Movie' ) {
                return true
            } else {
                return false;
            }
        })           
        break;
      case 'tv':
        search_data = data.filter(item => {
            if ((item.category.toLowerCase().match(search) || String(item.year).toLowerCase().match(search) || item.title.toLowerCase().match(search)) && item.category == 'TV Series' ) {
                return true
            } else {
                return false;
            }
        })           
        break;
      case 'bookmark':
        search_data = data.filter(item => {
            if ((item.category.toLowerCase().match(search) || String(item.year).toLowerCase().match(search) || item.title.toLowerCase().match(search)) && item.isBookmarked == true ) {
                return true
            } else {
                return false;
            }
        })           
        break;
    }
  
    resp = ''
    search_data.map(item => {
                    resp += generate_rec_item({
                        'url': item.thumbnail.regular.small,
                        'isBookmarked': item.isBookmarked,
                        'year': item.year,
                        'category': item.category,
                        'rating': item.rating,
                        'title': item.title
                    });
                })
    page = `<h2 class="pure-white mt-24 mb-24 heading-l">Found ${search_data.length} results for '${search}'</h2>
            <div class="rec-list">${resp}</div>`
    render(page, currentPage, false);
})

function route_to(arg, pageName) {
  render(arg, pageName)
  search_input.value = '';
}